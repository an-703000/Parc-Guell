<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Parc Guell</title>
<link rel="stylesheet" href="https://cdn.pannellum.org/2.5/pannellum.css"/>
<script src="https://cdn.pannellum.org/2.5/pannellum.js"></script>

<style>
html, body { 
    margin:0; 
    height:100%; 
    width:100%; 
    overflow:hidden; 
}

#panorama { 
    width:100%; 
    height:100%; 
}

/* ======================= */
/* HOTSPOT MINIMALE PUNTO */
/* ======================= */
.min-hotspot {
    width: 20px;
    height: 20px;
    background: red;
    border-radius: 50%;
    cursor: pointer;
    border: 2px solid white;
}

/* CONTENITORE IMMAGINE FLOTANTE */
#popup {
    display:none;
    position:fixed;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    background:white;
    padding:10px;
    z-index:9999;
    border-radius:10px;
}

#popup img {
    max-width:90vw;
    max-height:80vh;
    border-radius:8px;
}

#popup button {
    margin-top:10px;
    padding:6px 12px;
    border:none;
    border-radius:6px;
    cursor:pointer;
}
</style>
</head>

<body>

<div id="panorama"></div>

<!-- POPUP IMMAGINE -->
<div id="popup">
    <div id="mediaContainer"></div><br>
    <button onclick="closePopup()">Chiudi</button>
</div>

<script>
// Funzioni apertura/chiusura immagine
function openMedia(file){
    let container = document.getElementById("mediaContainer");
    container.innerHTML = '<img src="'+file+'">';
    document.getElementById("popup").style.display = "block";
}

function closePopup(){
    document.getElementById("popup").style.display = "none";
}

// Definizione scene e hotspot
var scenes = {

"scene1":{
    "type":"equirectangular",
    "panorama":"Parc Guell 1.jpg",
    "hotSpots":[
        {"pitch":0,"yaw":0,"type":"scene","text":"Vai a scena 2","sceneId":"scene2"}
    ]
},

"scene2":{
    "type":"equirectangular",
    "panorama":"Parc Guell 2.jpg",
    "hotSpots":[
        {"pitch":-20,"yaw":-180,"type":"scene","text":"Vai a scena 1","sceneId":"scene1"},
        {"pitch":0,"yaw":55,"type":"scene","text":"Vai a scena 3","sceneId":"scene3"},
        {"pitch":0,"yaw":-50,"type":"scene","text":"Vai a scena 4","sceneId":"scene4"},

        // hotspot foto
        {"pitch":-60,"yaw":-180,"type":"info",
            "createTooltipFunc": function(hotSpotDiv){
                hotSpotDiv.classList.add('min-hotspot');
                hotSpotDiv.onclick = function(e){ e.stopPropagation(); openMedia("El drac.jpg"); };
            }
        }
    ]
},

"scene3":{
    "type":"equirectangular",
    "panorama":"Parc Guell 3.jpg",
    "hotSpots":[
        {"pitch":0,"yaw":170,"type":"scene","text":"Vai a scena 2","sceneId":"scene2"},

        {"pitch":35,"yaw":160,"type":"info",
            "createTooltipFunc": function(hotSpotDiv){
                hotSpotDiv.classList.add('min-hotspot');
                hotSpotDiv.onclick = function(e){ e.stopPropagation(); openMedia("Mosaico sole.jpg"); };
            }
        }
    ]
},

"scene4":{
    "type":"equirectangular",
    "panorama":"Parc Guell 4.jpg",
    "hotSpots":[
        {"pitch":-5,"yaw":135,"type":"scene","text":"Vai a scena 2","sceneId":"scene2"},

        {"pitch":-30,"yaw":30,"type":"info",
            "createTooltipFunc": function(hotSpotDiv){
                hotSpotDiv.classList.add('min-hotspot');
                hotSpotDiv.onclick = function(e){ e.stopPropagation(); openMedia("Panchina.jpg"); };
            }
        },

        // hotspot Google Earth
        {"pitch":0,"yaw":-150,"type":"info",
            "createTooltipFunc": function(hotSpotDiv){
                hotSpotDiv.classList.add('min-hotspot');
                hotSpotDiv.onclick = function(e){ e.stopPropagation(); window.open("https://earth.google.com/earth/d/1j1wbTYDG8tGAcbo5Rz6Ug6Mm8R7XYg3l?usp=sharing","_blank"); };
            }
        }
    ]
}

};

// Inizializzazione Pannellum
pannellum.viewer('panorama',{
    "default":{"firstScene":"scene1","sceneFadeDuration":1000},
    "scenes":scenes,
    "autoLoad":true,
    "showFullscreenCtrl":true,
    "showVRCtrl":true
});

</script>

</body>
</html>
